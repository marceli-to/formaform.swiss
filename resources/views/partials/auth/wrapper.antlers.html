<div
  x-data="{
    hasFocus: false,
    showErrors: {{ errors:count > 0 ? 'true' : 'false' }}
  }">
  <div
    x-cloak
    x-show="auth || showErrors"
    @click="auth = false; showErrors = false"
    class="fixed left-0 top-0 z-10 bg-white/50 w-full h-full">
  </div>
  <div
    class="
      bg-olverra
      text-white
      font-spezia-medium
      font-medium
      text-xs
      fixed
      top-0
      lg:top-12
      right-0
      2xl:right-[calc(((100%_-_var(--max-width-container))_/_2))]
      z-30
      px-20
      lg:px-22
      w-full
      lg:max-w-[336px]
      min-h-dvh
      lg:min-h-[calc(100dvh_-_12px)]"
    x-cloak
    x-show="auth || showErrors"
    @click.outside="auth = false; showErrors = false"
    x-transition:enter="transition ease-out duration-100"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="transition ease-in duration-0"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0">

    <div class="flex justify-between items-center h-[var(--header-height-sm)] lg:h-[var(--header-height-lg)]">
      <span class="text-sm">
        {{ logged_in ? 'Logout' : 'Login' }}
      </span>
      <span>
        <a
          href="javascript:;"
          x-on:click="auth = false; showErrors = false"
          class="block w-14 h-auto">
          {{ partial:icons/login class="w-full h-auto text-white" }}
        </a>
      </span>
    </div>

    {{ if logged_in }}
    
      <div class="flex flex-col gap-y-14 {{ !is_homepage ? 'mt-10' : '' }} pt-20 lg:pt-0">
        <div>
          <span class="bg-white w-full flex items-center min-h-36 px-12 py-8 font-spezia-medium font-medium text-xs leading-none text-olverra placeholder:text-xs placeholder:text-olverra">
            {{ current_user.email }}
          </span>
        </div>
        <div>
          <a
            href="{{ user:logout_url redirect='{url}' }}"
            class="bg-dravine flex items-center gap-x-8 font-spezia-medium font-medium text-xs leading-none text-olverra w-full text-left px-12 py-11 hover:bg-white transition-colors">
            {{ partial:icons/arrow class="w-16 h-auto" }}
            Abmelden
          </a>
        </div>
      </div>

    {{ else }}

      <div data-auth="login-form">
        {{ user:login_form redirect="{{ url }}" error_redirect="{{ url }}" }}

          <div class="flex flex-col gap-y-14 pt-20 lg:pt-0 {{ !is_homepage ? 'mt-10' : '' }}">

            <div>
              <input
                type="email"
                name="email"
                value="{{ old:email }}"
                class="bg-white w-full px-12 py-8 font-spezia-medium font-medium text-xs leading-none text-olverra placeholder:text-xs placeholder:text-olverra !outline-none ring-0 focus:ring-0 focus-visible:ring-0"
                placeholder="E-Mail-Adresse"
                x-on:focus="hasFocus = true" />
            </div>

            <div>
              <input
                type="password"
                name="password"
                class="bg-white w-full px-12 py-8 font-spezia-medium font-medium text-xs leading-none text-olverra placeholder:text-xs placeholder:text-olverra !outline-none ring-0 focus:ring-0 focus-visible:ring-0"
                placeholder="Passwort"
                x-on:focus="hasFocus = true" />
            </div>

            <button
              type="submit"
              class="bg-dravine font-spezia-medium font-medium text-xs leading-none text-olverra block w-full text-left px-12 py-11 hover:bg-white transition-colors">
              Einloggen
            </button>

            {{ if errors }}
              <ul class="!mb-0 text-indian" x-show="!hasFocus && showErrors" data-auth="login-errors">
                {{ errors }}
                  <li>{{ value }}</li>
                {{ /errors }}
              </ul>
            {{ /if }}

            <div>
              <a
                href="javascript:;"
                @click="document.querySelector('[data-auth=login-form]').style.display='none'; document.querySelector('[data-auth=password-reset-form]').style.display='block'; const errors = document.querySelector('[data-auth=login-errors]'); if(errors) errors.style.display='none'"
                class="text-xs text-dravine hover:underline underline-offset-2">
                Passwort vergessen?
              </a>
            </div>

          </div>
        {{ /user:login_form }}
      </div>

      <div data-auth="password-reset-form" style="display: none;">
        <div class="pt-20 lg:pt-0 {{ !is_homepage ? 'mt-10' : '' }}">
          <div id="password-reset">
            <reset-password></reset-password>
          </div>
        </div>
      </div>
      {{ vite src="resources/js/password-reset.js" }}
    {{ /if }}
  </div>
</div>
